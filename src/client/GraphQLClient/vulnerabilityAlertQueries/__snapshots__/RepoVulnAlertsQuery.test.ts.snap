// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`RepoVulnAlertsQuery #iterateVulnerabilityAlerts Pulling data out with filters - GH Cloud 1`] = `
Object {
  "createdAt": "2022-01-18T19:01:43Z",
  "dependabotUpdate": Object {
    "error": null,
  },
  "dismissReason": null,
  "dismissedAt": null,
  "dismisser": null,
  "fixReason": null,
  "fixedAt": null,
  "number": 1,
  "repository": Object {
    "nameWithOwner": "JupiterOne/graph-signal-sciences",
  },
  "securityAdvisory": Object {
    "cvss": Object {
      "score": 8,
      "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
    },
    "cwes": Array [
      Object {
        "cweId": "CWE-359",
        "description": "The product does not properly prevent a person's private, personal information from being accessed by actors who either (1) are not explicitly authorized to access the information or (2) do not have the implicit consent of the person about whom the information is collected.",
        "name": "Exposure of Private Personal Information to an Unauthorized Actor",
      },
    ],
    "databaseId": 8532,
    "description": "follow-redirects is vulnerable to Exposure of Private Personal Information to an Unauthorized Actor",
    "ghsaId": "GHSA-74fj-2j2h-c42q",
    "id": "GSA_kwCzR0hTQS03NGZqLTJqMmgtYzQycc0hVA",
    "identifiers": Array [
      Object {
        "type": "GHSA",
        "value": "GHSA-74fj-2j2h-c42q",
      },
      Object {
        "type": "CVE",
        "value": "CVE-2022-0155",
      },
    ],
    "notificationsPermalink": "https://github.com/advisories/GHSA-74fj-2j2h-c42q/dependabot",
    "origin": "UNSPECIFIED",
    "permalink": "https://github.com/advisories/GHSA-74fj-2j2h-c42q",
    "publishedAt": "2022-01-12T22:46:26Z",
    "references": Array [
      Object {
        "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-0155",
      },
      Object {
        "url": "https://github.com/follow-redirects/follow-redirects/commit/8b347cbcef7c7b72a6e9be20f5710c17d6163c22",
      },
      Object {
        "url": "https://huntr.dev/bounties/fc524e4b-ebb6-427d-ab67-a64181020406",
      },
      Object {
        "url": "https://github.com/advisories/GHSA-74fj-2j2h-c42q",
      },
    ],
    "severity": "HIGH",
    "summary": "Exposure of sensitive information in follow-redirects",
    "updatedAt": "2022-01-20T15:34:49Z",
    "withdrawnAt": null,
  },
  "securityVulnerability": Object {
    "firstPatchedVersion": Object {
      "identifier": "1.14.7",
    },
    "package": Object {
      "ecosystem": "NPM",
      "name": "follow-redirects",
    },
    "severity": "HIGH",
    "updatedAt": "2022-01-11T18:41:09Z",
    "vulnerableVersionRange": "< 1.14.7",
  },
  "state": "OPEN",
  "vulnerableManifestFilename": "yarn.lock",
  "vulnerableManifestPath": "yarn.lock",
  "vulnerableRequirements": "= 1.14.5",
}
`;

exports[`RepoVulnAlertsQuery #iterateVulnerabilityAlerts Pulling data out with filters - GH Cloud 2`] = `
Object {
  "query": "
    query ($login: String!, $repoName: String!, $states: [RepositoryVulnerabilityAlertState!]!, $maxLimit: Int!, $alertsCursor: String) {

      repository(owner: $login, name: $repoName) {
        vulnerabilityAlerts(first: $maxLimit, after: $alertsCursor, states: $states) {

          nodes {
            id
            repository {
              nameWithOwner
            }
            createdAt
            dismissReason
            dismissedAt
            dismisser {
              login
              name
              email
            }
            fixReason
 number
 state
            securityAdvisory {
              cvss {
                vectorString
                score
              }
              cwes(first: $maxLimit) {
                nodes {
                  cweId
                  name
                  description
                }
              }
              databaseId
              description
              ghsaId
              id
              identifiers {
                type
                value
              }
              notificationsPermalink
              origin
              permalink
              publishedAt
              references {
                url
              }
              severity
              summary
              updatedAt
              withdrawnAt
            }
            securityVulnerability {
              firstPatchedVersion {
                identifier
              }
              package {
                name
                ecosystem
              }
              severity
              updatedAt
              vulnerableVersionRange
            }
            vulnerableManifestFilename
            vulnerableManifestPath
            vulnerableRequirements
          }
          pageInfo {
            endCursor
            hasNextPage
          }
        }
      }
      ...on Query {
    rateLimit {
      limit
      cost
      remaining
      resetAt
    }
  }
    }",
  "queryVariables": Object {
    "login": "J1-Test",
    "maxLimit": 100,
    "repoName": "happy-sunshine",
    "states": Array [
      "OPEN",
    ],
  },
}
`;

exports[`RepoVulnAlertsQuery #iterateVulnerabilityAlerts Pulling data out with filters - GH Cloud 3`] = `
Object {
  "query": "
    query ($login: String!, $repoName: String!, $states: [RepositoryVulnerabilityAlertState!]!, $maxLimit: Int!, $alertsCursor: String) {

      repository(owner: $login, name: $repoName) {
        vulnerabilityAlerts(first: $maxLimit, after: $alertsCursor, states: $states) {

          nodes {
            id
            repository {
              nameWithOwner
            }
            createdAt
            dismissReason
            dismissedAt
            dismisser {
              login
              name
              email
            }
            fixReason
 number
 state
            securityAdvisory {
              cvss {
                vectorString
                score
              }
              cwes(first: $maxLimit) {
                nodes {
                  cweId
                  name
                  description
                }
              }
              databaseId
              description
              ghsaId
              id
              identifiers {
                type
                value
              }
              notificationsPermalink
              origin
              permalink
              publishedAt
              references {
                url
              }
              severity
              summary
              updatedAt
              withdrawnAt
            }
            securityVulnerability {
              firstPatchedVersion {
                identifier
              }
              package {
                name
                ecosystem
              }
              severity
              updatedAt
              vulnerableVersionRange
            }
            vulnerableManifestFilename
            vulnerableManifestPath
            vulnerableRequirements
          }
          pageInfo {
            endCursor
            hasNextPage
          }
        }
      }
      ...on Query {
    rateLimit {
      limit
      cost
      remaining
      resetAt
    }
  }
    }",
  "queryVariables": Object {
    "alertsCursor": "Y3Vyc29yOnYyOpHOZUAZ1g==",
    "login": "J1-Test",
    "maxLimit": 100,
    "repoName": "happy-sunshine",
    "states": Array [
      "OPEN",
    ],
  },
  "rateLimit": Object {
    "cost": 1,
  },
}
`;

exports[`RepoVulnAlertsQuery #iterateVulnerabilityAlerts Pulling data out without filters - GH Cloud 1`] = `
Object {
  "createdAt": "2022-01-18T19:01:43Z",
  "dependabotUpdate": Object {
    "error": null,
  },
  "dismissReason": null,
  "dismissedAt": null,
  "dismisser": null,
  "fixReason": null,
  "fixedAt": null,
  "number": 1,
  "repository": Object {
    "nameWithOwner": "JupiterOne/graph-signal-sciences",
  },
  "securityAdvisory": Object {
    "cvss": Object {
      "score": 8,
      "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
    },
    "cwes": Array [
      Object {
        "cweId": "CWE-359",
        "description": "The product does not properly prevent a person's private, personal information from being accessed by actors who either (1) are not explicitly authorized to access the information or (2) do not have the implicit consent of the person about whom the information is collected.",
        "name": "Exposure of Private Personal Information to an Unauthorized Actor",
      },
    ],
    "databaseId": 8532,
    "description": "follow-redirects is vulnerable to Exposure of Private Personal Information to an Unauthorized Actor",
    "ghsaId": "GHSA-74fj-2j2h-c42q",
    "id": "GSA_kwCzR0hTQS03NGZqLTJqMmgtYzQycc0hVA",
    "identifiers": Array [
      Object {
        "type": "GHSA",
        "value": "GHSA-74fj-2j2h-c42q",
      },
      Object {
        "type": "CVE",
        "value": "CVE-2022-0155",
      },
    ],
    "notificationsPermalink": "https://github.com/advisories/GHSA-74fj-2j2h-c42q/dependabot",
    "origin": "UNSPECIFIED",
    "permalink": "https://github.com/advisories/GHSA-74fj-2j2h-c42q",
    "publishedAt": "2022-01-12T22:46:26Z",
    "references": Array [
      Object {
        "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-0155",
      },
      Object {
        "url": "https://github.com/follow-redirects/follow-redirects/commit/8b347cbcef7c7b72a6e9be20f5710c17d6163c22",
      },
      Object {
        "url": "https://huntr.dev/bounties/fc524e4b-ebb6-427d-ab67-a64181020406",
      },
      Object {
        "url": "https://github.com/advisories/GHSA-74fj-2j2h-c42q",
      },
    ],
    "severity": "HIGH",
    "summary": "Exposure of sensitive information in follow-redirects",
    "updatedAt": "2022-01-20T15:34:49Z",
    "withdrawnAt": null,
  },
  "securityVulnerability": Object {
    "firstPatchedVersion": Object {
      "identifier": "1.14.7",
    },
    "package": Object {
      "ecosystem": "NPM",
      "name": "follow-redirects",
    },
    "severity": "HIGH",
    "updatedAt": "2022-01-11T18:41:09Z",
    "vulnerableVersionRange": "< 1.14.7",
  },
  "state": "OPEN",
  "vulnerableManifestFilename": "yarn.lock",
  "vulnerableManifestPath": "yarn.lock",
  "vulnerableRequirements": "= 1.14.5",
}
`;

exports[`RepoVulnAlertsQuery #iterateVulnerabilityAlerts Pulling data out without filters - GH Cloud 2`] = `
Object {
  "createdAt": "2022-02-15T08:00:02Z",
  "dependabotUpdate": Object {
    "error": null,
  },
  "dismissReason": null,
  "dismissedAt": null,
  "dismisser": null,
  "fixReason": null,
  "fixedAt": null,
  "number": 2,
  "repository": Object {
    "nameWithOwner": "JupiterOne/graph-signal-sciences",
  },
  "securityAdvisory": Object {
    "cvss": Object {
      "score": 5.9,
      "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
    },
    "cwes": Array [
      Object {
        "cweId": "CWE-200",
        "description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
      },
    ],
    "databaseId": 10791,
    "description": "Exposure of Sensitive Information to an Unauthorized Actor in NPM follow-redirects prior to 1.14.8.",
    "ghsaId": "GHSA-pw2r-vq6v-hr8c",
    "id": "GSA_kwCzR0hTQS1wdzJyLXZxNnYtaHI4Y80qJw",
    "identifiers": Array [
      Object {
        "type": "GHSA",
        "value": "GHSA-pw2r-vq6v-hr8c",
      },
      Object {
        "type": "CVE",
        "value": "CVE-2022-0536",
      },
    ],
    "notificationsPermalink": "https://github.com/advisories/GHSA-pw2r-vq6v-hr8c/dependabot",
    "origin": "UNSPECIFIED",
    "permalink": "https://github.com/advisories/GHSA-pw2r-vq6v-hr8c",
    "publishedAt": "2022-02-10T00:00:31Z",
    "references": Array [
      Object {
        "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-0536",
      },
      Object {
        "url": "https://github.com/follow-redirects/follow-redirects/commit/62e546a99c07c3ee5e4e0718c84a6ca127c5c445",
      },
      Object {
        "url": "https://huntr.dev/bounties/7cf2bf90-52da-4d59-8028-a73b132de0db",
      },
      Object {
        "url": "https://github.com/advisories/GHSA-pw2r-vq6v-hr8c",
      },
    ],
    "severity": "MODERATE",
    "summary": "Exposure of Sensitive Information to an Unauthorized Actor in follow-redirects",
    "updatedAt": "2022-02-14T22:27:57Z",
    "withdrawnAt": null,
  },
  "securityVulnerability": Object {
    "firstPatchedVersion": Object {
      "identifier": "1.14.8",
    },
    "package": Object {
      "ecosystem": "NPM",
      "name": "follow-redirects",
    },
    "severity": "MODERATE",
    "updatedAt": "2022-02-11T21:18:03Z",
    "vulnerableVersionRange": "< 1.14.8",
  },
  "state": "OPEN",
  "vulnerableManifestFilename": "yarn.lock",
  "vulnerableManifestPath": "yarn.lock",
  "vulnerableRequirements": "= 1.14.7",
}
`;

exports[`RepoVulnAlertsQuery #iterateVulnerabilityAlerts Pulling data out without filters - GH Cloud 3`] = `
Object {
  "query": "
    query ($login: String!, $repoName: String!, $states: [RepositoryVulnerabilityAlertState!]!, $maxLimit: Int!, $alertsCursor: String) {

      repository(owner: $login, name: $repoName) {
        vulnerabilityAlerts(first: $maxLimit, after: $alertsCursor, states: $states) {

          nodes {
            id
            repository {
              nameWithOwner
            }
            createdAt
            dismissReason
            dismissedAt
            dismisser {
              login
              name
              email
            }
            fixReason
 number
 state
            securityAdvisory {
              cvss {
                vectorString
                score
              }
              cwes(first: $maxLimit) {
                nodes {
                  cweId
                  name
                  description
                }
              }
              databaseId
              description
              ghsaId
              id
              identifiers {
                type
                value
              }
              notificationsPermalink
              origin
              permalink
              publishedAt
              references {
                url
              }
              severity
              summary
              updatedAt
              withdrawnAt
            }
            securityVulnerability {
              firstPatchedVersion {
                identifier
              }
              package {
                name
                ecosystem
              }
              severity
              updatedAt
              vulnerableVersionRange
            }
            vulnerableManifestFilename
            vulnerableManifestPath
            vulnerableRequirements
          }
          pageInfo {
            endCursor
            hasNextPage
          }
        }
      }
      ...on Query {
    rateLimit {
      limit
      cost
      remaining
      resetAt
    }
  }
    }",
  "queryVariables": Object {
    "login": "J1-Test",
    "maxLimit": 100,
    "repoName": "happy-sunshine",
    "states": Array [
      "FIXED",
      "DISMISSED",
      "OPEN",
    ],
  },
}
`;

exports[`RepoVulnAlertsQuery #iterateVulnerabilityAlerts Pulling data out without filters - GH Cloud 4`] = `
Object {
  "query": "
    query ($login: String!, $repoName: String!, $states: [RepositoryVulnerabilityAlertState!]!, $maxLimit: Int!, $alertsCursor: String) {

      repository(owner: $login, name: $repoName) {
        vulnerabilityAlerts(first: $maxLimit, after: $alertsCursor, states: $states) {

          nodes {
            id
            repository {
              nameWithOwner
            }
            createdAt
            dismissReason
            dismissedAt
            dismisser {
              login
              name
              email
            }
            fixReason
 number
 state
            securityAdvisory {
              cvss {
                vectorString
                score
              }
              cwes(first: $maxLimit) {
                nodes {
                  cweId
                  name
                  description
                }
              }
              databaseId
              description
              ghsaId
              id
              identifiers {
                type
                value
              }
              notificationsPermalink
              origin
              permalink
              publishedAt
              references {
                url
              }
              severity
              summary
              updatedAt
              withdrawnAt
            }
            securityVulnerability {
              firstPatchedVersion {
                identifier
              }
              package {
                name
                ecosystem
              }
              severity
              updatedAt
              vulnerableVersionRange
            }
            vulnerableManifestFilename
            vulnerableManifestPath
            vulnerableRequirements
          }
          pageInfo {
            endCursor
            hasNextPage
          }
        }
      }
      ...on Query {
    rateLimit {
      limit
      cost
      remaining
      resetAt
    }
  }
    }",
  "queryVariables": Object {
    "alertsCursor": "Y3Vyc29yOnYyOpHOZUAZ1g==",
    "login": "J1-Test",
    "maxLimit": 100,
    "repoName": "happy-sunshine",
    "states": Array [
      "FIXED",
      "DISMISSED",
      "OPEN",
    ],
  },
  "rateLimit": Object {
    "cost": 1,
  },
}
`;

exports[`RepoVulnAlertsQuery #iterateVulnerabilityAlerts Pulling data out without filters - GHE Server 3.3.3 1`] = `
Object {
  "createdAt": "2022-01-18T19:01:43Z",
  "dependabotUpdate": Object {
    "error": null,
  },
  "dismissReason": null,
  "dismissedAt": null,
  "dismisser": null,
  "fixReason": null,
  "fixedAt": null,
  "number": 1,
  "repository": Object {
    "nameWithOwner": "JupiterOne/graph-signal-sciences",
  },
  "securityAdvisory": Object {
    "cvss": Object {
      "score": 8,
      "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
    },
    "cwes": Array [
      Object {
        "cweId": "CWE-359",
        "description": "The product does not properly prevent a person's private, personal information from being accessed by actors who either (1) are not explicitly authorized to access the information or (2) do not have the implicit consent of the person about whom the information is collected.",
        "name": "Exposure of Private Personal Information to an Unauthorized Actor",
      },
    ],
    "databaseId": 8532,
    "description": "follow-redirects is vulnerable to Exposure of Private Personal Information to an Unauthorized Actor",
    "ghsaId": "GHSA-74fj-2j2h-c42q",
    "id": "GSA_kwCzR0hTQS03NGZqLTJqMmgtYzQycc0hVA",
    "identifiers": Array [
      Object {
        "type": "GHSA",
        "value": "GHSA-74fj-2j2h-c42q",
      },
      Object {
        "type": "CVE",
        "value": "CVE-2022-0155",
      },
    ],
    "notificationsPermalink": "https://github.com/advisories/GHSA-74fj-2j2h-c42q/dependabot",
    "origin": "UNSPECIFIED",
    "permalink": "https://github.com/advisories/GHSA-74fj-2j2h-c42q",
    "publishedAt": "2022-01-12T22:46:26Z",
    "references": Array [
      Object {
        "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-0155",
      },
      Object {
        "url": "https://github.com/follow-redirects/follow-redirects/commit/8b347cbcef7c7b72a6e9be20f5710c17d6163c22",
      },
      Object {
        "url": "https://huntr.dev/bounties/fc524e4b-ebb6-427d-ab67-a64181020406",
      },
      Object {
        "url": "https://github.com/advisories/GHSA-74fj-2j2h-c42q",
      },
    ],
    "severity": "HIGH",
    "summary": "Exposure of sensitive information in follow-redirects",
    "updatedAt": "2022-01-20T15:34:49Z",
    "withdrawnAt": null,
  },
  "securityVulnerability": Object {
    "firstPatchedVersion": Object {
      "identifier": "1.14.7",
    },
    "package": Object {
      "ecosystem": "NPM",
      "name": "follow-redirects",
    },
    "severity": "HIGH",
    "updatedAt": "2022-01-11T18:41:09Z",
    "vulnerableVersionRange": "< 1.14.7",
  },
  "state": "OPEN",
  "vulnerableManifestFilename": "yarn.lock",
  "vulnerableManifestPath": "yarn.lock",
  "vulnerableRequirements": "= 1.14.5",
}
`;

exports[`RepoVulnAlertsQuery #iterateVulnerabilityAlerts Pulling data out without filters - GHE Server 3.3.3 2`] = `
Object {
  "createdAt": "2022-02-15T08:00:02Z",
  "dependabotUpdate": Object {
    "error": null,
  },
  "dismissReason": null,
  "dismissedAt": null,
  "dismisser": null,
  "fixReason": null,
  "fixedAt": null,
  "number": 2,
  "repository": Object {
    "nameWithOwner": "JupiterOne/graph-signal-sciences",
  },
  "securityAdvisory": Object {
    "cvss": Object {
      "score": 5.9,
      "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
    },
    "cwes": Array [
      Object {
        "cweId": "CWE-200",
        "description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
      },
    ],
    "databaseId": 10791,
    "description": "Exposure of Sensitive Information to an Unauthorized Actor in NPM follow-redirects prior to 1.14.8.",
    "ghsaId": "GHSA-pw2r-vq6v-hr8c",
    "id": "GSA_kwCzR0hTQS1wdzJyLXZxNnYtaHI4Y80qJw",
    "identifiers": Array [
      Object {
        "type": "GHSA",
        "value": "GHSA-pw2r-vq6v-hr8c",
      },
      Object {
        "type": "CVE",
        "value": "CVE-2022-0536",
      },
    ],
    "notificationsPermalink": "https://github.com/advisories/GHSA-pw2r-vq6v-hr8c/dependabot",
    "origin": "UNSPECIFIED",
    "permalink": "https://github.com/advisories/GHSA-pw2r-vq6v-hr8c",
    "publishedAt": "2022-02-10T00:00:31Z",
    "references": Array [
      Object {
        "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-0536",
      },
      Object {
        "url": "https://github.com/follow-redirects/follow-redirects/commit/62e546a99c07c3ee5e4e0718c84a6ca127c5c445",
      },
      Object {
        "url": "https://huntr.dev/bounties/7cf2bf90-52da-4d59-8028-a73b132de0db",
      },
      Object {
        "url": "https://github.com/advisories/GHSA-pw2r-vq6v-hr8c",
      },
    ],
    "severity": "MODERATE",
    "summary": "Exposure of Sensitive Information to an Unauthorized Actor in follow-redirects",
    "updatedAt": "2022-02-14T22:27:57Z",
    "withdrawnAt": null,
  },
  "securityVulnerability": Object {
    "firstPatchedVersion": Object {
      "identifier": "1.14.8",
    },
    "package": Object {
      "ecosystem": "NPM",
      "name": "follow-redirects",
    },
    "severity": "MODERATE",
    "updatedAt": "2022-02-11T21:18:03Z",
    "vulnerableVersionRange": "< 1.14.8",
  },
  "state": "OPEN",
  "vulnerableManifestFilename": "yarn.lock",
  "vulnerableManifestPath": "yarn.lock",
  "vulnerableRequirements": "= 1.14.7",
}
`;

exports[`RepoVulnAlertsQuery #iterateVulnerabilityAlerts Pulling data out without filters - GHE Server 3.3.3 3`] = `
Object {
  "query": "
    query ($login: String!, $repoName: String!, $maxLimit: Int!, $alertsCursor: String) {

      repository(owner: $login, name: $repoName) {
        vulnerabilityAlerts(first: $maxLimit, after: $alertsCursor) {

          nodes {
            id
            repository {
              nameWithOwner
            }
            createdAt
            dismissReason
            dismissedAt
            dismisser {
              login
              name
              email
            }
            
            securityAdvisory {
              cvss {
                vectorString
                score
              }
              cwes(first: $maxLimit) {
                nodes {
                  cweId
                  name
                  description
                }
              }
              databaseId
              description
              ghsaId
              id
              identifiers {
                type
                value
              }
              notificationsPermalink
              origin
              permalink
              publishedAt
              references {
                url
              }
              severity
              summary
              updatedAt
              withdrawnAt
            }
            securityVulnerability {
              firstPatchedVersion {
                identifier
              }
              package {
                name
                ecosystem
              }
              severity
              updatedAt
              vulnerableVersionRange
            }
            vulnerableManifestFilename
            vulnerableManifestPath
            vulnerableRequirements
          }
          pageInfo {
            endCursor
            hasNextPage
          }
        }
      }
      ...on Query {
    rateLimit {
      limit
      cost
      remaining
      resetAt
    }
  }
    }",
  "queryVariables": Object {
    "login": "J1-Test",
    "maxLimit": 100,
    "repoName": "happy-sunshine",
    "states": Array [
      "FIXED",
      "DISMISSED",
      "OPEN",
    ],
  },
}
`;

exports[`RepoVulnAlertsQuery #iterateVulnerabilityAlerts Pulling data out without filters - GHE Server 3.3.3 4`] = `
Object {
  "query": "
    query ($login: String!, $repoName: String!, $maxLimit: Int!, $alertsCursor: String) {

      repository(owner: $login, name: $repoName) {
        vulnerabilityAlerts(first: $maxLimit, after: $alertsCursor) {

          nodes {
            id
            repository {
              nameWithOwner
            }
            createdAt
            dismissReason
            dismissedAt
            dismisser {
              login
              name
              email
            }
            
            securityAdvisory {
              cvss {
                vectorString
                score
              }
              cwes(first: $maxLimit) {
                nodes {
                  cweId
                  name
                  description
                }
              }
              databaseId
              description
              ghsaId
              id
              identifiers {
                type
                value
              }
              notificationsPermalink
              origin
              permalink
              publishedAt
              references {
                url
              }
              severity
              summary
              updatedAt
              withdrawnAt
            }
            securityVulnerability {
              firstPatchedVersion {
                identifier
              }
              package {
                name
                ecosystem
              }
              severity
              updatedAt
              vulnerableVersionRange
            }
            vulnerableManifestFilename
            vulnerableManifestPath
            vulnerableRequirements
          }
          pageInfo {
            endCursor
            hasNextPage
          }
        }
      }
      ...on Query {
    rateLimit {
      limit
      cost
      remaining
      resetAt
    }
  }
    }",
  "queryVariables": Object {
    "alertsCursor": "Y3Vyc29yOnYyOpHOZUAZ1g==",
    "login": "J1-Test",
    "maxLimit": 100,
    "repoName": "happy-sunshine",
    "states": Array [
      "FIXED",
      "DISMISSED",
      "OPEN",
    ],
  },
  "rateLimit": Object {
    "cost": 1,
  },
}
`;

exports[`RepoVulnAlertsQuery Pulling data out with filters - GHE Server 3.5.0 1`] = `
Object {
  "createdAt": "2022-01-18T19:01:43Z",
  "dependabotUpdate": Object {
    "error": null,
  },
  "dismissReason": null,
  "dismissedAt": null,
  "dismisser": null,
  "fixReason": null,
  "fixedAt": null,
  "number": 1,
  "repository": Object {
    "nameWithOwner": "JupiterOne/graph-signal-sciences",
  },
  "securityAdvisory": Object {
    "cvss": Object {
      "score": 8,
      "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
    },
    "cwes": Array [
      Object {
        "cweId": "CWE-359",
        "description": "The product does not properly prevent a person's private, personal information from being accessed by actors who either (1) are not explicitly authorized to access the information or (2) do not have the implicit consent of the person about whom the information is collected.",
        "name": "Exposure of Private Personal Information to an Unauthorized Actor",
      },
    ],
    "databaseId": 8532,
    "description": "follow-redirects is vulnerable to Exposure of Private Personal Information to an Unauthorized Actor",
    "ghsaId": "GHSA-74fj-2j2h-c42q",
    "id": "GSA_kwCzR0hTQS03NGZqLTJqMmgtYzQycc0hVA",
    "identifiers": Array [
      Object {
        "type": "GHSA",
        "value": "GHSA-74fj-2j2h-c42q",
      },
      Object {
        "type": "CVE",
        "value": "CVE-2022-0155",
      },
    ],
    "notificationsPermalink": "https://github.com/advisories/GHSA-74fj-2j2h-c42q/dependabot",
    "origin": "UNSPECIFIED",
    "permalink": "https://github.com/advisories/GHSA-74fj-2j2h-c42q",
    "publishedAt": "2022-01-12T22:46:26Z",
    "references": Array [
      Object {
        "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-0155",
      },
      Object {
        "url": "https://github.com/follow-redirects/follow-redirects/commit/8b347cbcef7c7b72a6e9be20f5710c17d6163c22",
      },
      Object {
        "url": "https://huntr.dev/bounties/fc524e4b-ebb6-427d-ab67-a64181020406",
      },
      Object {
        "url": "https://github.com/advisories/GHSA-74fj-2j2h-c42q",
      },
    ],
    "severity": "HIGH",
    "summary": "Exposure of sensitive information in follow-redirects",
    "updatedAt": "2022-01-20T15:34:49Z",
    "withdrawnAt": null,
  },
  "securityVulnerability": Object {
    "firstPatchedVersion": Object {
      "identifier": "1.14.7",
    },
    "package": Object {
      "ecosystem": "NPM",
      "name": "follow-redirects",
    },
    "severity": "HIGH",
    "updatedAt": "2022-01-11T18:41:09Z",
    "vulnerableVersionRange": "< 1.14.7",
  },
  "state": "OPEN",
  "vulnerableManifestFilename": "yarn.lock",
  "vulnerableManifestPath": "yarn.lock",
  "vulnerableRequirements": "= 1.14.5",
}
`;

exports[`RepoVulnAlertsQuery Pulling data out with filters - GHE Server 3.5.0 2`] = `
Object {
  "query": "
    query ($login: String!, $repoName: String!, $states: [RepositoryVulnerabilityAlertState!]!, $maxLimit: Int!, $alertsCursor: String) {

      repository(owner: $login, name: $repoName) {
        vulnerabilityAlerts(first: $maxLimit, after: $alertsCursor, states: $states) {

          nodes {
            id
            repository {
              nameWithOwner
            }
            createdAt
            dismissReason
            dismissedAt
            dismisser {
              login
              name
              email
            }
            fixReason
 number
 state
            securityAdvisory {
              cvss {
                vectorString
                score
              }
              cwes(first: $maxLimit) {
                nodes {
                  cweId
                  name
                  description
                }
              }
              databaseId
              description
              ghsaId
              id
              identifiers {
                type
                value
              }
              notificationsPermalink
              origin
              permalink
              publishedAt
              references {
                url
              }
              severity
              summary
              updatedAt
              withdrawnAt
            }
            securityVulnerability {
              firstPatchedVersion {
                identifier
              }
              package {
                name
                ecosystem
              }
              severity
              updatedAt
              vulnerableVersionRange
            }
            vulnerableManifestFilename
            vulnerableManifestPath
            vulnerableRequirements
          }
          pageInfo {
            endCursor
            hasNextPage
          }
        }
      }
      ...on Query {
    rateLimit {
      limit
      cost
      remaining
      resetAt
    }
  }
    }",
  "queryVariables": Object {
    "login": "J1-Test",
    "maxLimit": 100,
    "repoName": "happy-sunshine",
    "states": Array [
      "OPEN",
    ],
  },
}
`;

exports[`RepoVulnAlertsQuery Pulling data out with filters - GHE Server 3.5.0 3`] = `
Object {
  "query": "
    query ($login: String!, $repoName: String!, $states: [RepositoryVulnerabilityAlertState!]!, $maxLimit: Int!, $alertsCursor: String) {

      repository(owner: $login, name: $repoName) {
        vulnerabilityAlerts(first: $maxLimit, after: $alertsCursor, states: $states) {

          nodes {
            id
            repository {
              nameWithOwner
            }
            createdAt
            dismissReason
            dismissedAt
            dismisser {
              login
              name
              email
            }
            fixReason
 number
 state
            securityAdvisory {
              cvss {
                vectorString
                score
              }
              cwes(first: $maxLimit) {
                nodes {
                  cweId
                  name
                  description
                }
              }
              databaseId
              description
              ghsaId
              id
              identifiers {
                type
                value
              }
              notificationsPermalink
              origin
              permalink
              publishedAt
              references {
                url
              }
              severity
              summary
              updatedAt
              withdrawnAt
            }
            securityVulnerability {
              firstPatchedVersion {
                identifier
              }
              package {
                name
                ecosystem
              }
              severity
              updatedAt
              vulnerableVersionRange
            }
            vulnerableManifestFilename
            vulnerableManifestPath
            vulnerableRequirements
          }
          pageInfo {
            endCursor
            hasNextPage
          }
        }
      }
      ...on Query {
    rateLimit {
      limit
      cost
      remaining
      resetAt
    }
  }
    }",
  "queryVariables": Object {
    "alertsCursor": "Y3Vyc29yOnYyOpHOZUAZ1g==",
    "login": "J1-Test",
    "maxLimit": 100,
    "repoName": "happy-sunshine",
    "states": Array [
      "OPEN",
    ],
  },
  "rateLimit": Object {
    "cost": 1,
  },
}
`;
